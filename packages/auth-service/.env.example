# Authentication Service Configuration
# Copy to .env and fill in your values

# ==================== JWT Configuration ====================
JWT_ALGORITHM=HS256
JWT_SECRET=change-me-to-a-secure-random-string-at-least-32-chars
JWT_ISSUER=noa-server
JWT_AUDIENCE=noa-client
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# For RS256/ES256, provide key paths instead of secret
# JWT_PRIVATE_KEY_PATH=/path/to/private.key
# JWT_PUBLIC_KEY_PATH=/path/to/public.key

# ==================== Database Configuration ====================
DATABASE_URL=postgresql://noa:password@localhost:5432/noa
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_SSL=false

# ==================== Redis Configuration ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=change-me-to-secure-password
REDIS_DB=0
REDIS_TLS=false

# ==================== Password Policy ====================
PASSWORD_MIN_LENGTH=12
PASSWORD_MAX_LENGTH=128
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_PREVENT_COMMON=true
PASSWORD_PREVENT_BREACHED=true
PASSWORD_PREVENT_REUSE=5
PASSWORD_MAX_AGE_DAYS=90
PASSWORD_MIN_AGE_DAYS=1

# ==================== MFA Configuration ====================
MFA_ENABLED=true
MFA_ISSUER=Noa Server
MFA_WINDOW=1
MFA_DIGITS=6
MFA_STEP=30

# ==================== Session Configuration ====================
SESSION_MAX_AGE=86400000
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict

# ==================== Rate Limiting ====================
RATE_LIMIT_LOGIN_POINTS=5
RATE_LIMIT_LOGIN_DURATION=900
RATE_LIMIT_LOGIN_BLOCK_DURATION=900

RATE_LIMIT_REGISTER_POINTS=3
RATE_LIMIT_REGISTER_DURATION=3600
RATE_LIMIT_REGISTER_BLOCK_DURATION=86400

RATE_LIMIT_API_POINTS=100
RATE_LIMIT_API_DURATION=60

# ==================== OAuth Configuration ====================
# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=https://your-domain.com/auth/google/callback

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=https://your-domain.com/auth/github/callback

# Microsoft OAuth
MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_TENANT_ID=common
MICROSOFT_CALLBACK_URL=https://your-domain.com/auth/microsoft/callback

# ==================== SAML Configuration ====================
SAML_ENABLED=false
SAML_ENTRY_POINT=https://idp.example.com/sso
SAML_ISSUER=noa-server
SAML_CERT_PATH=/path/to/idp-cert.pem
SAML_PRIVATE_KEY_PATH=/path/to/sp-private.key
SAML_CALLBACK_URL=https://your-domain.com/auth/saml/callback

# ==================== LDAP Configuration ====================
LDAP_ENABLED=false
LDAP_URL=ldap://ldap.example.com:389
LDAP_BIND_DN=cn=admin,dc=example,dc=com
LDAP_BIND_PASSWORD=your-ldap-password
LDAP_SEARCH_BASE=ou=users,dc=example,dc=com
LDAP_SEARCH_FILTER=(uid={{username}})
LDAP_TLS=false

# ==================== Email Configuration ====================
# For password reset, MFA codes, etc.
EMAIL_FROM=noreply@your-domain.com
EMAIL_HOST=smtp.example.com
EMAIL_PORT=587
EMAIL_SECURE=true
EMAIL_USER=your-smtp-username
EMAIL_PASSWORD=your-smtp-password

# ==================== Security ====================
# Brute force protection
BRUTE_FORCE_FREE_RETRIES=5
BRUTE_FORCE_MIN_WAIT=900000
BRUTE_FORCE_MAX_WAIT=900000
BRUTE_FORCE_LIFETIME=86400000

# CORS
CORS_ORIGIN=https://your-frontend.com
CORS_CREDENTIALS=true

# CSRF
CSRF_SECRET=change-me-to-secure-random-string

# ==================== Monitoring ====================
LOG_LEVEL=info
LOG_FORMAT=json
METRICS_ENABLED=true
METRICS_PORT=9090

# ==================== Feature Flags ====================
FEATURE_OAUTH=true
FEATURE_SAML=false
FEATURE_LDAP=false
FEATURE_MFA=true
FEATURE_WEBAUTHN=false
FEATURE_MAGIC_LINK=false

# ==================== Environment ====================
NODE_ENV=production
PORT=3000
HOST=0.0.0.0
